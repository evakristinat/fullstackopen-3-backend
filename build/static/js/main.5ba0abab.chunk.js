(this.webpackJsonppuhelinluettelo=this.webpackJsonppuhelinluettelo||[]).push([[0],{21:function(e,n,t){},42:function(e,n,t){},43:function(e,n,t){"use strict";t.r(n);var c=t(16),r=t.n(c),a=t(7),o=t(3),u=t(2),i=(t(21),t(0)),s=function(e){var n=e.search,t=e.handleSearchChange;return Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)("label",{children:"filter shown with"}),Object(i.jsx)("input",{type:"search",value:n,onChange:t})]})},l=function(e){var n=e.addPerson,t=e.newName,c=e.newNumber,r=e.handleNameChange,a=e.handleNumberChange;return Object(i.jsxs)("form",{onSubmit:n,children:[Object(i.jsx)("label",{children:"name: "}),Object(i.jsx)("input",{type:"text",value:t,onChange:r}),Object(i.jsx)("label",{children:"number:"}),Object(i.jsx)("input",{type:"tel",minLength:"10",value:c,onChange:a}),Object(i.jsx)("button",{type:"submit",children:"add"})]})},d=function(e){var n=e.personsToShow,t=e.removePerson;return Object(i.jsx)("table",{children:Object(i.jsx)("tbody",{children:n.map((function(e){return Object(i.jsxs)("tr",{children:[Object(i.jsx)("td",{children:e.name},e.name),Object(i.jsx)("td",{children:e.number},e.number),Object(i.jsx)("td",{children:Object(i.jsx)("button",{value:e.id,onClick:t,children:"delete"})})]},e.id)}))})})},h=function(e){var n=e.message,t=e.error;return n?Object(i.jsx)("div",{className:"success",children:n}):t?Object(i.jsx)("div",{className:"error",children:t}):null},b=t(4),f=t.n(b),j="http://localhost:3001/api/persons",m={getAll:function(){return f.a.get(j).then((function(e){return e.data}))},create:function(e){return f.a.post(j,e).then((function(e){return e.data}))},update:function(e,n){return f.a.put("".concat(j,"/").concat(e),n).then((function(e){return e}))},remove:function(e){return f.a.delete("".concat(j,"/").concat(e)).then((function(e){return e.data}))}},O=function(){var e=Object(u.useState)([]),n=Object(o.a)(e,2),t=n[0],c=n[1],r=Object(u.useState)(""),b=Object(o.a)(r,2),f=b[0],j=b[1],O=Object(u.useState)(""),p=Object(o.a)(O,2),x=p[0],v=p[1],g=Object(u.useState)(""),w=Object(o.a)(g,2),y=w[0],N=w[1],C=Object(u.useState)(null),S=Object(o.a)(C,2),P=S[0],k=S[1],T=Object(u.useState)(null),I=Object(o.a)(T,2),A=I[0],D=I[1];Object(u.useEffect)((function(){m.getAll().then((function(e){c(e)})).catch((function(e){D("The data from the server couldn't be reached"),B(5)}))}),[]);var E=function(){return t.findIndex((function(e){return e.name===f.trim()}))>-1},L=function(){return t.findIndex((function(e){return e.number===x.trim()}))>-1},J=function(){j(""),v("")},B=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;setTimeout((function(){k(null),D(null)}),1e3*e)},F=y.match(/\d/)?t.filter((function(e){return e.number.includes(y)})):"string"===typeof y?t.filter((function(e){return e.name.toLowerCase().includes(y.toLowerCase())})):t,G=function(e,n){var r=t.find((function(e){return e.name===n})).id,o=t.find((function(e){return e.id===r})),u=Object(a.a)(Object(a.a)({},o),{},{number:e});m.update(r,u).then((function(e){if(404===e.status)throw new Error("404");c(t.map((function(n){return n.id!==r?n:e.data}))),k("".concat(o.name,"'s number was successfully updated"))})).catch((function(e){D("Information of ".concat(o.name," has already been deleted")),B(5)})),J()};return Object(i.jsxs)("main",{children:[Object(i.jsx)("h2",{children:"Phonebook"}),Object(i.jsx)(s,{search:y,handleSearchChange:function(e){N(e.target.value)}}),Object(i.jsx)("div",{className:"notification-box",children:Object(i.jsx)(h,{message:P,error:A})}),Object(i.jsx)("h3",{children:"Add new"}),Object(i.jsx)(l,{addPerson:function(e){if(e.preventDefault(),m.getAll().then((function(e){c(e)})).catch((function(e){D("The data from the server couldn't be reached"),B(5)})),f&&x){var n={name:f.trim(),number:x.trim()};E()||L()?E()&&!L()?window.confirm("".concat(n.name," is already added to phonebook, replace the old number with a new one?"))?G(n.number,n.name):console.log("canceled"):!E()&&L()?(D("Given phonenumber is already in use"),B()):E()&&L()&&(D("".concat(f.trim()," has already been added to phonebook")),B()):m.create(n).then((function(e){c(t.concat(e)),k("".concat(e.name," was successfully added")),B(3)})).catch((function(e){D("No data could be found"),B(6)})),J()}},newName:f,newNumber:x,handleNameChange:function(e){j(e.target.value)},handleNumberChange:function(e){v(e.target.value)}}),Object(i.jsx)("h3",{children:"Numbers"}),Object(i.jsx)(d,{personsToShow:F,removePerson:function(e){var n=parseInt(e.target.value),r=t.find((function(e){return e.id===n}));window.confirm("Delete ".concat(r.name," ?"))?m.remove(n).then((function(){c(t.filter((function(e){return e.id!==n}))),k("Successfully deleted ".concat(r.name)),B(3)})).catch((function(e){D("The person could not be found. Please refresh and retry."),B()})):console.log("Delete canceled")},setPersons:c})]})};t(42);r.a.render(Object(i.jsx)(O,{}),document.getElementById("root"))}},[[43,1,2]]]);
//# sourceMappingURL=main.5ba0abab.chunk.js.map